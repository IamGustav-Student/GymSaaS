@using GymSaaS.Application.Accesos.Commands.RegistrarAcceso
@model AccesoDto

@{
    ViewData["Title"] = "Control de Acceso";
    Layout = "~/Views/Shared/_LayoutMD3.cshtml";
    // El código único del gimnasio para autocheckin
    var gymCheckInCode = ViewData["GymCode"]?.ToString() ?? "GYM-DEFAULT";
}

<div class="container-fluid mt-4">
    <div class="row g-4">
        <div class="col-md-6">
            <div class="glass-panel p-4 h-100 border-primary border-opacity-25">
                <h2 class="brand-font text-gradient mb-4"><i class="bi bi-camera me-2"></i>ESCANEAR SOCIO</h2>
                <div id="reader" style="width: 100%; border-radius: 15px; overflow: hidden;" class="bg-dark"></div>
                <div id="resultado-scanner" class="mt-4 text-center">
                    <p class="text-secondary text-uppercase tracking-widest">Esperando escaneo...</p>
                </div>
            </div>
        </div>

        <div class="col-md-6">
            <div class="glass-panel p-4 h-100 border-info border-opacity-25 text-center d-flex flex-column justify-content-center">
                <h2 class="brand-font text-info mb-4">AUTO CHECK-IN</h2>
                <p class="text-secondary small mb-4">Si no hay personal en puerta, escaneá este código con tu App Gymvo</p>

                <div class="bg-white p-3 d-inline-block mx-auto rounded-3 shadow-glow" style="max-width: 300px;">
                    <img src="https://api.qrserver.com/v1/create-qr-code/?size=250x250&data=@gymCheckInCode"
                         alt="QR Gimnasio" class="img-fluid" />
                </div>

                <h3 class="brand-font text-white mt-4">@gymCheckInCode</h3>
                <div class="badge bg-info bg-opacity-10 text-info mt-2">CÓDIGO DE SEDE</div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://unpkg.com/html5-qrcode"></script>
    <script src="~/js/gymvo-scanner.js"></script>
}

<style>
    .shadow-glow {
        box-shadow: 0 0 20px rgba(0, 243, 255, 0.4);
    }

    #reader {
        border: 2px solid rgba(0, 243, 255, 0.2) !important;
    }
</style>